<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Systems Lab 6: Inbuilt Functions and Relational Algebra Operations</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.1em;
            opacity: 0.9;
        }
        .content {
            padding: 30px;
        }
        .section {
            margin-bottom: 40px;
            border-left: 4px solid #667eea;
            padding-left: 25px;
        }
        .section h2 {
            color: #667eea;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .section h3 {
            color: #555;
            margin-top: 25px;
        }
        .schema-table {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            margin: 15px 0;
            overflow: hidden;
        }
        .schema-table h4 {
            background: #667eea;
            color: white;
            margin: 0;
            padding: 12px 15px;
            font-size: 1.1em;
        }
        .schema-content {
            padding: 15px;
        }
        .sql-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            border-left: 4px solid #667eea;
        }
        .sql-block pre {
            margin: 0;
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre-wrap;
        }
        .relational-algebra {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .relational-algebra h5 {
            color: #856404;
            margin: 0 0 10px 0;
            font-size: 1em;
        }
        .relational-algebra .formula {
            font-family: 'Times New Roman', serif;
            font-size: 1.1em;
            font-style: italic;
            color: #495057;
        }
        .explanation {
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        .explanation h5 {
            color: #0056b3;
            margin: 0 0 10px 0;
        }
        .query-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #dee2e6;
        }
        .query-number {
            background: #667eea;
            color: white;
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
        }
        .table th, .table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }
        .table tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .note {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .note strong {
            color: #155724;
        }
        .key-points {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
        }
        .key-points h5 {
            color: #155724;
            margin: 0 0 10px 0;
        }
        .operator {
            background: #667eea;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>EXPERIMENT-6</h1>
            <p><strong>Use of Inbuilt Functions and Relational Algebra Operations</strong></p>
            <p>Database Systems | MTech First Semester | Dr. Mohsin Dar</p>
            <p>SOCS | UPES</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>üìö Objective</h2>
                <p>To understand the use of inbuilt functions and relational algebra operations with SQL queries using the COMPANY database schema.</p>
            </div>

            <div class="section">
                <h2>üèóÔ∏è COMPANY Database Schema</h2>
                
                <div class="schema-table">
                    <h4>EMPLOYEE Table</h4>
                    <div class="schema-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Column</th>
                                    <th>Data Type</th>
                                    <th>Constraints</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>SSN</td><td>CHAR(9)</td><td>PRIMARY KEY</td><td>Social Security Number</td></tr>
                                <tr><td>FNAME</td><td>VARCHAR(15)</td><td>NOT NULL</td><td>First Name</td></tr>
                                <tr><td>MINIT</td><td>CHAR(1)</td><td></td><td>Middle Initial</td></tr>
                                <tr><td>LNAME</td><td>VARCHAR(15)</td><td>NOT NULL</td><td>Last Name</td></tr>
                                <tr><td>BDATE</td><td>DATE</td><td></td><td>Birth Date</td></tr>
                                <tr><td>ADDRESS</td><td>VARCHAR(30)</td><td></td><td>Employee Address</td></tr>
                                <tr><td>SEX</td><td>CHAR(1)</td><td></td><td>Gender</td></tr>
                                <tr><td>SALARY</td><td>DECIMAL(10,2)</td><td></td><td>Employee Salary</td></tr>
                                <tr><td>SUPER_SSN</td><td>CHAR(9)</td><td>FOREIGN KEY</td><td>Supervisor SSN</td></tr>
                                <tr><td>DNO</td><td>INT</td><td>FOREIGN KEY</td><td>Department Number</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="schema-table">
                    <h4>DEPARTMENT Table</h4>
                    <div class="schema-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Column</th>
                                    <th>Data Type</th>
                                    <th>Constraints</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>DNAME</td><td>VARCHAR(15)</td><td>NOT NULL</td><td>Department Name</td></tr>
                                <tr><td>DNUMBER</td><td>INT</td><td>PRIMARY KEY</td><td>Department Number</td></tr>
                                <tr><td>MGR_SSN</td><td>CHAR(9)</td><td>FOREIGN KEY</td><td>Manager SSN</td></tr>
                                <tr><td>MGR_START_DATE</td><td>DATE</td><td></td><td>Manager Start Date</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="schema-table">
                    <h4>PROJECT Table</h4>
                    <div class="schema-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Column</th>
                                    <th>Data Type</th>
                                    <th>Constraints</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>PNAME</td><td>VARCHAR(15)</td><td>NOT NULL</td><td>Project Name</td></tr>
                                <tr><td>PNUMBER</td><td>INT</td><td>PRIMARY KEY</td><td>Project Number</td></tr>
                                <tr><td>PLOCATION</td><td>VARCHAR(15)</td><td></td><td>Project Location</td></tr>
                                <tr><td>DNUM</td><td>INT</td><td>FOREIGN KEY</td><td>Department Number</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="schema-table">
                    <h4>WORKS_ON Table</h4>
                    <div class="schema-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Column</th>
                                    <th>Data Type</th>
                                    <th>Constraints</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>ESSN</td><td>CHAR(9)</td><td>PRIMARY KEY, FOREIGN KEY</td><td>Employee SSN</td></tr>
                                <tr><td>PNO</td><td>INT</td><td>PRIMARY KEY, FOREIGN KEY</td><td>Project Number</td></tr>
                                <tr><td>HOURS</td><td>DECIMAL(3,1)</td><td></td><td>Hours Worked</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="schema-table">
                    <h4>DEPENDENT Table</h4>
                    <div class="schema-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Column</th>
                                    <th>Data Type</th>
                                    <th>Constraints</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>ESSN</td><td>CHAR(9)</td><td>PRIMARY KEY, FOREIGN KEY</td><td>Employee SSN</td></tr>
                                <tr><td>DEPENDENT_NAME</td><td>VARCHAR(15)</td><td>PRIMARY KEY</td><td>Dependent Name</td></tr>
                                <tr><td>SEX</td><td>CHAR(1)</td><td></td><td>Gender</td></tr>
                                <tr><td>BDATE</td><td>DATE</td><td></td><td>Birth Date</td></tr>
                                <tr><td>RELATIONSHIP</td><td>VARCHAR(8)</td><td></td><td>Relationship to Employee</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="schema-table">
                    <h4>DEPT_LOCATIONS Table</h4>
                    <div class="schema-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Column</th>
                                    <th>Data Type</th>
                                    <th>Constraints</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>DNUMBER</td><td>INT</td><td>PRIMARY KEY, FOREIGN KEY</td><td>Department Number</td></tr>
                                <tr><td>DLOCATION</td><td>VARCHAR(15)</td><td>PRIMARY KEY</td><td>Department Location</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üîß Key Concepts</h2>
                
                <div class="key-points">
                    <h5>Relational Algebra Operations</h5>
                    <p><span class="operator">œÉ</span> <strong>Selection:</strong> Selects rows that satisfy a condition</p>
                    <p><span class="operator">œÄ</span> <strong>Projection:</strong> Selects specific columns</p>
                    <p><span class="operator">‚ãà</span> <strong>Join:</strong> Combines tables based on related columns</p>
                    <p><span class="operator">‚à™</span> <strong>Union:</strong> Combines results from multiple queries</p>
                    <p><span class="operator">‚à©</span> <strong>Intersection:</strong> Common rows between two relations</p>
                    <p><span class="operator">‚àí</span> <strong>Difference:</strong> Rows in first relation but not in second</p>
                </div>

                <div class="key-points">
                    <h5>SQL Inbuilt Functions</h5>
                    <p><strong>Aggregate Functions:</strong> COUNT(), SUM(), AVG(), MAX(), MIN()</p>
                    <p><strong>String Functions:</strong> UPPER(), LOWER(), SUBSTRING(), LENGTH()</p>
                    <p><strong>Date Functions:</strong> YEAR(), MONTH(), DAY(), CURRENT_DATE()</p>
                    <p><strong>Conditional Functions:</strong> CASE, COALESCE(), NULLIF()</p>
                </div>
            </div>

            <div class="section">
                <h2>üéØ Query Solutions</h2>

                <div class="query-section">
                    <div class="query-number">Query 1</div>
                    <h3>Retrieve the names of all employees in department 5 who work more than 10 hours per week on the 'ProductX' project.</h3>
                    
                    <div class="relational-algebra">
                        <h5>Relational Algebra:</h5>
                        <div class="formula">
                            œÄ<sub>FNAME,LNAME</sub>(œÉ<sub>DNO=5 ‚àß HOURS>10 ‚àß PNAME='ProductX'</sub>(EMPLOYEE ‚ãà WORKS_ON ‚ãà PROJECT))
                        </div>
                    </div>

                    <div class="sql-block">
                        <pre>SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
JOIN WORKS_ON W ON E.SSN = W.ESSN
JOIN PROJECT P ON W.PNO = P.PNUMBER
WHERE E.DNO = 5 
  AND W.HOURS > 10 
  AND P.PNAME = 'ProductX';</pre>
                    </div>

                    <div class="explanation">
                        <h5>Explanation:</h5>
                        <p>This query uses multiple JOIN operations to combine three tables. We filter employees by department number 5, hours worked greater than 10, and project name 'ProductX'. The projection operation selects only the first and last names.</p>
                    </div>
                </div>

                <div class="query-section">
                    <div class="query-number">Query 2</div>
                    <h3>List the names of all employees who have a dependent with the same first name as themselves.</h3>
                    
                    <div class="relational-algebra">
                        <h5>Relational Algebra:</h5>
                        <div class="formula">
                            œÄ<sub>FNAME,LNAME</sub>(œÉ<sub>FNAME=DEPENDENT_NAME</sub>(EMPLOYEE ‚ãà<sub>SSN=ESSN</sub> DEPENDENT))
                        </div>
                    </div>

                    <div class="sql-block">
                        <pre>SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
JOIN DEPENDENT D ON E.SSN = D.ESSN
WHERE E.FNAME = D.DEPENDENT_NAME;</pre>
                    </div>

                    <div class="explanation">
                        <h5>Explanation:</h5>
                        <p>This query joins the EMPLOYEE and DEPENDENT tables on the SSN/ESSN relationship, then filters where the employee's first name matches their dependent's name. This demonstrates self-referential comparison within joined tables.</p>
                    </div>
                </div>

                <div class="query-section">
                    <div class="query-number">Query 3</div>
                    <h3>Find the names of employees who are directly supervised by 'Franklin Wong'.</h3>
                    
                    <div class="relational-algebra">
                        <h5>Relational Algebra:</h5>
                        <div class="formula">
                            œÄ<sub>E1.FNAME,E1.LNAME</sub>(œÉ<sub>E2.FNAME='Franklin' ‚àß E2.LNAME='Wong'</sub>(EMPLOYEE E1 ‚ãà<sub>E1.SUPER_SSN=E2.SSN</sub> EMPLOYEE E2))
                        </div>
                    </div>

                    <div class="sql-block">
                        <pre>SELECT E1.FNAME, E1.LNAME
FROM EMPLOYEE E1
JOIN EMPLOYEE E2 ON E1.SUPER_SSN = E2.SSN
WHERE E2.FNAME = 'Franklin' 
  AND E2.LNAME = 'Wong';</pre>
                    </div>

                    <div class="explanation">
                        <h5>Explanation:</h5>
                        <p>This is a self-join query where we alias the EMPLOYEE table twice. E1 represents subordinates and E2 represents supervisors. We join on the supervisor relationship and filter for Franklin Wong as the supervisor.</p>
                    </div>
                </div>

                <div class="query-section">
                    <div class="query-number">Query 4</div>
                    <h3>Retrieve the names of employees who work on every project.</h3>
                    
                    <div class="relational-algebra">
                        <h5>Relational Algebra:</h5>
                        <div class="formula">
                            œÄ<sub>FNAME,LNAME</sub>(EMPLOYEE ‚ãà (œÄ<sub>ESSN</sub>(WORKS_ON) √∑ œÄ<sub>PNUMBER</sub>(PROJECT)))
                        </div>
                    </div>

                    <div class="sql-block">
                        <pre>SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
WHERE NOT EXISTS (
    SELECT P.PNUMBER
    FROM PROJECT P
    WHERE NOT EXISTS (
        SELECT W.PNO
        FROM WORKS_ON W
        WHERE W.ESSN = E.SSN 
          AND W.PNO = P.PNUMBER
    )
);</pre>
                    </div>

                    <div class="explanation">
                        <h5>Explanation:</h5>
                        <p>This query uses the division operation concept implemented with double negation (NOT EXISTS). It finds employees for whom there doesn't exist any project that they don't work on - meaning they work on all projects.</p>
                    </div>
                </div>

                <div class="query-section">
                    <div class="query-number">Query 5</div>
                    <h3>Retrieve the names of employees who do not work on any project.</h3>
                    
                    <div class="relational-algebra">
                        <h5>Relational Algebra:</h5>
                        <div class="formula">
                            œÄ<sub>FNAME,LNAME</sub>(EMPLOYEE ‚àí œÄ<sub>FNAME,LNAME</sub>(EMPLOYEE ‚ãà<sub>SSN=ESSN</sub> WORKS_ON))
                        </div>
                    </div>

                    <div class="sql-block">
                        <pre>SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
WHERE E.SSN NOT IN (
    SELECT DISTINCT W.ESSN
    FROM WORKS_ON W
    WHERE W.ESSN IS NOT NULL
);</pre>
                    </div>

                    <div class="explanation">
                        <h5>Explanation:</h5>
                        <p>This query uses the difference operation to find employees who are not in the WORKS_ON table. The NOT IN clause excludes employees who have any project assignments.</p>
                    </div>
                </div>

                <div class="query-section">
                    <div class="query-number">Query 6</div>
                    <h3>Retrieve the names and addresses of all employees who work on at least one project located in Houston but whose department has no location in Houston.</h3>
                    
                    <div class="relational-algebra">
                        <h5>Relational Algebra:</h5>
                        <div class="formula">
                            œÄ<sub>FNAME,LNAME,ADDRESS</sub>((EMPLOYEE ‚ãà WORKS_ON ‚ãà œÉ<sub>PLOCATION='Houston'</sub>(PROJECT)) ‚àí (EMPLOYEE ‚ãà œÉ<sub>DLOCATION='Houston'</sub>(DEPT_LOCATIONS)))
                        </div>
                    </div>

                    <div class="sql-block">
                        <pre>SELECT DISTINCT E.FNAME, E.LNAME, E.ADDRESS
FROM EMPLOYEE E
JOIN WORKS_ON W ON E.SSN = W.ESSN
JOIN PROJECT P ON W.PNO = P.PNUMBER
WHERE P.PLOCATION = 'Houston'
  AND E.DNO NOT IN (
      SELECT DL.DNUMBER
      FROM DEPT_LOCATIONS DL
      WHERE DL.DLOCATION = 'Houston'
  );</pre>
                    </div>

                    <div class="explanation">
                        <h5>Explanation:</h5>
                        <p>This complex query finds employees who work on Houston projects but their department isn't located in Houston. It combines positive selection (works on Houston projects) with negative selection (department not in Houston).</p>
                    </div>
                </div>

                <div class="query-section">
                    <div class="query-number">Query 7</div>
                    <h3>Retrieve the last names of all department managers who have no dependents.</h3>
                    
                    <div class="relational-algebra">
                        <h5>Relational Algebra:</h5>
                        <div class="formula">
                            œÄ<sub>LNAME</sub>(œÉ<sub>SSN=MGR_SSN</sub>(EMPLOYEE ‚ãà DEPARTMENT) ‚àí œÄ<sub>LNAME</sub>(œÉ<sub>SSN=ESSN</sub>(EMPLOYEE ‚ãà DEPENDENT)))
                        </div>
                    </div>

                    <div class="sql-block">
                        <pre>SELECT E.LNAME
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.SSN = D.MGR_SSN
WHERE E.SSN NOT IN (
    SELECT DISTINCT DEP.ESSN
    FROM DEPENDENT DEP
    WHERE DEP.ESSN IS NOT NULL
);</pre>
                    </div>

                    <div class="explanation">
                        <h5>Explanation:</h5>
                        <p>This query identifies department managers (by joining EMPLOYEE and DEPARTMENT on manager SSN) who are not in the DEPENDENT table as employees with dependents. It combines role-based selection with exclusion logic.</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üìä Sample Data and Expected Results</h2>
                
                <div class="note">
                    <strong>Note:</strong> The following sample data demonstrates the structure and relationships in the COMPANY database. Actual results will depend on the specific data in your database instance.
                </div>

                <div class="schema-table">
                    <h4>Sample EMPLOYEE Data</h4>
                    <div class="schema-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>SSN</th>
                                    <th>FNAME</th>
                                    <th>LNAME</th>
                                    <th>ADDRESS</th>
                                    <th>DNO</th>
                                    <th>SUPER_SSN</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>123456789</td><td>John</td><td>Smith</td><td>731 Fondren, Houston TX</td><td>5</td><td>333445555</td></tr>
                                <tr><td>333445555</td><td>Franklin</td><td>Wong</td><td>638 Voss, Houston TX</td><td>5</td><td>888665555</td></tr>
                                <tr><td>999887777</td><td>Alicia</td><td>Zelaya</td><td>3321 Castle, Spring TX</td><td>4</td><td>987654321</td></tr>
                                <tr><td>987654321</td><td>Jennifer</td><td>Wallace</td><td>291 Berry, Bellaire TX</td><td>4</td><td>888665555</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üí° Advanced Topics</h2>
                
                <div class="explanation">
                    <h5>Query Optimization Tips:</h5>
                    <ul>
                        <li>Use appropriate indexes on frequently joined columns</li>
                        <li>Consider query execution plans for complex operations</li>
                        <li>Use EXIST instead of IN for better performance with NULLs</li>
                        <li>Avoid unnecessary DISTINCT operations</li>
                    </ul>
                </div>

                <div class="explanation">
                    <h5>Common Pitfalls:</h5>
                    <ul>
                        <li>NULL values in NOT IN clauses can produce unexpected results</li>
                        <li>Self-joins require careful aliasing to avoid confusion</li>
                        <li>Division queries (universal quantification) are complex and require double negation</li>
                        <li>Always consider cardinality when using JOINs</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>üìù Practice Exercises</h2>
                
                <div class="query-section">
                    <h3>Additional Practice Problems:</h3>
                    <ol>
                        <li>Find employees who work on more than 3 projects</li>
                        <li>List departments with more than 5 employees</li>
                        <li>Retrieve projects with no assigned employees</li>
                        <li>Find the highest paid employee in each department</li>
                        <li>List employees who have the same supervisor as 'John Smith'</li>
                    </ol>
                </div>
            </div>

            <div class="section">
                <h2>üéØ Learning Outcomes</h2>
                <p>After completing this lab, students should be able to:</p>
                <ul>
                    <li>Understand and apply fundamental relational algebra operations</li>
                    <li>Write complex SQL queries involving multiple tables and conditions</li>
                    <li>Use various types of JOIN operations effectively</li>
                    <li>Implement universal quantification using double negation</li>
                    <li>Handle NULL values appropriately in queries</li>
                    <li>Optimize query performance through proper indexing and query structure</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>